<!DOCTYPE html>
<html>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.9.0/d3.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

<head>
    <title>D3.js Demo</title>
    <meta charset="UTF-8">
    <style type="text/css">
        /* Axis font size */
        .axis {
            font: 14px sans-serif;
        }

        /* Text font size */
        .label {
            font: 15px sans-serif;
        }

        /* Title font size */
        .title {
            font: 20px sans-serif;
            text-anchor: middle;
        }
    </style>
</head>

<body>
    <h1>Kyrylo Kozlovskyi</h1>
    <script type="text/javascript">
        // plot CO2 graph
        function plotCO2Data(data) {
            // Set up SVG size and margins
            var margin = { top: 50, right: 50, bottom: 50, left: 50 }, width = 980 - margin.left - margin.right, height = 670 - margin.top - margin.bottom;

            // Scales
            // parse the date/time
            var x = d3.scaleLinear()
                .domain(d3.extent(data, function (d) { return (d["years_before_2023"]); }))
                .range([0, width]);

            console.log(x)
            var y = d3.scaleLinear().domain(d3.extent(data, function (d) { return d["co2_ppmv"]; })).range([height, 0]);

            // Axes
            // x is the d3.scaleLinear()
            var xAxis = d3.axisBottom(x).ticks(3); // specify the number of ticks
            // y is the d3.scaleLinear()
            var yAxis = d3.axisLeft(y).ticks(3); // specify the number of ticks

            // Line
            var valueLine = d3.line() //draw line - map x, y coords for each data point ising scales
                .x(function (d) { return x(d["years_before_2023"]) })
                .y(function (d) { return y(d["co2_ppmv"]) });

            // Draw 
            var svg = d3.select("body")
                .append("svg")
                .attr("width", width + margin.left + margin.right)
                .attr("height", height + margin.top + margin.bottom)
                .append("g")
                .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

            // Append the x-axis
            svg.append("g")
                .attr("class", "x axis")
                .attr("transform", "translate(0," + height + ")") // Move x-axis to the bottom
                .call(xAxis);

            // Add the x-axis label
            svg.append("text")
                .attr("class", "label")
                .attr("x", width / 2)
                .attr("y", height + margin.bottom - 10) // Positioning below the x-axis
                .style("text-anchor", "middle")
                .text("Years Before 2023");

            // Append the y-axis
            svg.append("g")
                .attr("class", "y axis")
                .call(yAxis);

            // Add the y-axis label
            svg.append("text")
                .attr("class", "label")
                .attr("transform", "rotate(-90)") // Rotate for vertical alignment
                .attr("x", -height / 2) // Center along the y-axis
                .attr("y", -margin.left + 12) // Position left of the y-axis
                .style("text-anchor", "middle")
                .text("CO2 (ppmv)");
                
            // Append elements to the DOM
            svg.append("path").attr("d", valueLine(data)).attr("fill", "none")
                .attr("stroke", "red");
        }

        // JSON call to api
        $.getJSON("https://tinyurl.com/k4chnujx", function (data) {
            // print to console
            console.log(data);
            //call function
            plotCO2Data(data);
        });
    </script>
</body>

</html>